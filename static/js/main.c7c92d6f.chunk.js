(this["webpackJsonpreact-quiz-app"]=this["webpackJsonpreact-quiz-app"]||[]).push([[0],{10:function(t,e,s){t.exports={enabled:"CanvasToolbar_enabled__14dm-",disabled:"CanvasToolbar_disabled__3R6Af",invertx:"CanvasToolbar_invertx__1Q_zF"}},100:function(t,e,s){"use strict";s.r(e);var i=s(0),o=s.n(i),r=s(25),n=s.n(r),a=s(1),c=s(5),l=s(10),h=s.n(l),u=s(26),d=s.n(u),f=s(14),v=s.n(f),m=s(27),g=s.n(m);const p=t=>{let{imgUrl:e,altText:s,invertX:i,size:r,enabled:n,clickCallback:a}=t;return o.a.createElement("img",{src:e,className:`\n    ${n?h.a.enabled:h.a.disabled} ${i?"":h.a.invertx}\n    `,alt:s,title:s,height:r+"px",width:r+"px",onClick:a})};p.defaultProps={invertX:!1};var w=t=>{let{topPosition:e,leftPosition:s,canUndo:i,canRedo:r,downloadCallback:n,undoCallback:a,redoCallback:c,resetCallback:l}=t;const h=[{imgUrl:g.a,altText:"download",invertX:!1,enabled:!0,clickCallback:n},{imgUrl:v.a,altText:"Undo",invertX:!0,enabled:i,clickCallback:i?a:()=>{}},{imgUrl:v.a,altText:"Redo",invertX:!1,enabled:r,clickCallback:r?c:()=>{}},{imgUrl:d.a,altText:"Reset canvas & history",invertX:!1,enabled:!0,clickCallback:l}];return o.a.createElement("div",{style:{position:"absolute",top:e+4,left:s,display:"flex",flexDirection:"column",gap:4,zIndex:20}},h.map(t=>o.a.createElement(p,{key:t.altText,imgUrl:t.imgUrl,altText:t.altText,invertX:t.invertX,size:24,enabled:t.enabled,clickCallback:t.clickCallback})))};const k={shouldReloadCanvas:!1,forceSendToStreamlit:!1},b={shouldReloadCanvas:!0,forceSendToStreamlit:!1},C={shouldReloadCanvas:!1,forceSendToStreamlit:!0},M={shouldReloadCanvas:!0,forceSendToStreamlit:!0},A=(t,e)=>{switch(e.type){case"save":if(!e.state)throw new Error("No action state to save");if(Object(c.isEmpty)(t.currentState))return{history:{undoStack:[],redoStack:[]},action:{...k},initialState:e.state,currentState:e.state};if(Object(c.isEqual)(e.state,t.currentState))return{history:{...t.history},action:{...k},initialState:t.initialState,currentState:t.currentState};{const s=t.history.undoStack.length>=100;return{history:{undoStack:[...t.history.undoStack.slice(s?1:0),t.currentState],redoStack:[]},action:{...k},initialState:null==t.initialState?t.currentState:t.initialState,currentState:e.state}}case"undo":if(0===t.history.undoStack.length)return{history:{...t.history},action:{...k},initialState:t.initialState,currentState:t.currentState};{const e=t.history.undoStack[t.history.undoStack.length-1];return{history:{undoStack:t.history.undoStack.slice(0,-1),redoStack:[...t.history.redoStack,t.currentState]},action:{...b},initialState:t.initialState,currentState:e}}case"redo":if(t.history.redoStack.length>0){const e=t.history.redoStack[t.history.redoStack.length-1];return{history:{undoStack:[...t.history.undoStack,t.currentState],redoStack:t.history.redoStack.slice(0,-1)},action:{...b},initialState:t.initialState,currentState:e}}return{history:{...t.history},action:{...k},initialState:t.initialState,currentState:t.currentState};case"reset":if(!e.state)throw new Error("No action state to store in reset");return{history:{undoStack:[],redoStack:[]},action:{...M},initialState:e.state,currentState:e.state};case"forceSendToStreamlit":return{history:{...t.history},action:{...C},initialState:t.initialState,currentState:t.currentState};default:throw new Error("TS should protect from this")}},S={history:{undoStack:[],redoStack:[]},action:{forceSendToStreamlit:!1,shouldReloadCanvas:!1},initialState:{},currentState:{}},_=Object(i.createContext)({}),y=t=>{let{children:e}=t;const[s,r]=Object(i.useReducer)(A,S),n=Object(i.useCallback)(t=>{console.log("Saving state 1:",t),r({type:"save",state:t})},[r]),a=Object(i.useCallback)(()=>{console.log("Undoing last action 2"),r({type:"undo"})},[r]),c=Object(i.useCallback)(()=>{console.log("Redoing last action 3"),r({type:"redo"})},[r]),l=Object(i.useCallback)(()=>r({type:"forceSendToStreamlit"}),[r]),h=Object(i.useCallback)(t=>{console.log("Resetting state 4"),r({type:"reset",state:t})},[r]),u=s.history.undoStack.length>0,d=s.history.redoStack.length>0;return o.a.createElement(_.Provider,{value:{canvasState:s,saveState:n,undo:a,redo:c,canUndo:u,canRedo:d,forceStreamlitUpdate:l,resetState:h}},e)};var x=class{constructor(t){this._canvas=void 0,this._canvas=t}};var D=class extends x{constructor(){super(...arguments),this.isMouseDown=!1,this.strokeWidth=10,this.strokeColor="#ffffff",this.currentLine=new a.fabric.Line,this.startCircle=new a.fabric.Circle,this.singlearrow=new a.fabric.Group,this.endTriangle=new a.fabric.Triangle}configureCanvas(t){let{strokeWidth:e,strokeColor:s}=t;return this._canvas.isDrawingMode=!1,this._canvas.selection=!1,this._canvas.forEachObject(t=>t.selectable=t.evented=!1),this.strokeWidth=e,this.strokeColor=s,this._canvas.on("mouse:down",t=>this.onMouseDown(t)),this._canvas.on("mouse:move",t=>this.onMouseMove(t)),this._canvas.on("mouse:up",t=>this.onMouseUp(t)),this._canvas.on("mouse:out",t=>this.onMouseOut(t)),()=>{this._canvas.off("mouse:down"),this._canvas.off("mouse:move"),this._canvas.off("mouse:up"),this._canvas.off("mouse:out")}}onMouseDown(t){let e=this._canvas,s=t.e.button;this.isMouseDown=!0;var i=e.getPointer(t.e),o=[i.x,i.y,i.x,i.y];this.currentLine=new a.fabric.Line(o,{strokeWidth:this.strokeWidth,fill:this.strokeColor,stroke:this.strokeColor,originX:"center",originY:"center",selectable:!1,evented:!1}),0===s&&e.add(this.singlearrow)}onMouseMove(t){if(!this.isMouseDown)return;let e=this._canvas;var s=e.getPointer(t.e);this.currentLine.set({x2:s.x,y2:s.y}),this.singlearrow&&e.remove(this.singlearrow);let i=0,o=0,r=0,n=0;i=this.currentLine.y2,o=this.currentLine.y1,r=this.currentLine.x2,n=this.currentLine.x1;var c,l=Math.atan2(i-o,r-n);this.endTriangle=new a.fabric.Triangle({left:s.x,top:s.y,originX:"center",originY:"center",strokeWidth:this.strokeWidth,stroke:this.strokeColor,fill:this.strokeColor,selectable:!1,evented:!1,width:5*this.strokeWidth,height:5*this.strokeWidth,angle:l*(180/Math.PI)+90}),this.singlearrow=new a.fabric.Group([this.currentLine,this.endTriangle],{selectable:!1,evented:!1}),this.singlearrow.toObject=(c=this.singlearrow.toObject,function(){return a.fabric.util.object.extend(c.call(this),{toolType:"SingleArrowHeadTool"})}),e.add(this.singlearrow),e.renderAll()}onMouseUp(t){this.isMouseDown=!1;let e=this._canvas;var s=this.singlearrow;e.remove(this.singlearrow),e.add(s),e.renderAll()}onMouseOut(t){this.isMouseDown=!1}};var E=class extends x{constructor(){super(...arguments),this.isMouseDown=!1,this.strokeWidth=10,this.strokeColor="#ffffff",this.currentLine=new a.fabric.Line,this.startCircle=new a.fabric.Circle,this.doublearrow=new a.fabric.Group,this.startTriangle=new a.fabric.Triangle,this.endTriangle=new a.fabric.Triangle}configureCanvas(t){let{strokeWidth:e,strokeColor:s}=t;return this._canvas.isDrawingMode=!1,this._canvas.selection=!1,this._canvas.forEachObject(t=>t.selectable=t.evented=!1),this.strokeWidth=e,this.strokeColor=s,this._canvas.on("mouse:down",t=>this.onMouseDown(t)),this._canvas.on("mouse:move",t=>this.onMouseMove(t)),this._canvas.on("mouse:up",t=>this.onMouseUp(t)),this._canvas.on("mouse:out",t=>this.onMouseOut(t)),()=>{this._canvas.off("mouse:down"),this._canvas.off("mouse:move"),this._canvas.off("mouse:up"),this._canvas.off("mouse:out")}}onMouseDown(t){let e=this._canvas,s=t.e.button;this.isMouseDown=!0;var i=e.getPointer(t.e),o=[i.x,i.y,i.x,i.y];this.currentLine=new a.fabric.Line(o,{strokeWidth:this.strokeWidth,fill:this.strokeColor,stroke:this.strokeColor,originX:"center",originY:"center",selectable:!1,evented:!1}),0===s&&e.add(this.doublearrow)}onMouseMove(t){if(!this.isMouseDown)return;let e=this._canvas;var s=e.getPointer(t.e);this.currentLine.set({x2:s.x,y2:s.y}),this.currentLine.setCoords(),this.doublearrow&&e.remove(this.doublearrow);let i=0,o=0,r=0,n=0;i=this.currentLine.y2,o=this.currentLine.y1,r=this.currentLine.x2,n=this.currentLine.x1;var c=Math.atan2(i-o,r-n);this.endTriangle=new a.fabric.Triangle({left:s.x,top:s.y,originX:"center",originY:"center",strokeWidth:this.strokeWidth,stroke:this.strokeColor,fill:this.strokeColor,selectable:!1,evented:!1,width:5*this.strokeWidth,height:5*this.strokeWidth,angle:c*(180/Math.PI)+90}),this.startTriangle=new a.fabric.Triangle({left:this.currentLine.x1,top:this.currentLine.y1,originX:"center",originY:"center",strokeWidth:this.strokeWidth,stroke:this.strokeColor,fill:this.strokeColor,selectable:!1,evented:!1,width:5*this.strokeWidth,height:5*this.strokeWidth,angle:c*(180/Math.PI)-90}),this.doublearrow=new a.fabric.Group([this.currentLine,this.startTriangle,this.endTriangle],{selectable:!1,evented:!1}),e.add(this.doublearrow),e.renderAll()}onMouseUp(t){this.isMouseDown=!1;let e=this._canvas;var s=this.doublearrow;e.remove(this.doublearrow),e.add(s),e.renderAll()}onMouseOut(t){this.isMouseDown=!1}};var L=class extends x{constructor(){super(...arguments),this.isMouseDown=!1,this.fillColor="#ffffff",this.strokeWidth=10,this.strokeColor="#ffffff",this.currentCircle=new a.fabric.Circle,this.currentStartX=0,this.currentStartY=0,this._minRadius=10,this.linearDistance=(t,e)=>{let s=e.x-t.x,i=e.y-t.y;return Math.sqrt(s*s+i*i)}}configureCanvas(t){let{strokeWidth:e,strokeColor:s,fillColor:i}=t;return this._canvas.isDrawingMode=!1,this._canvas.selection=!1,this._canvas.forEachObject(t=>t.selectable=t.evented=!1),this.strokeWidth=e,this.strokeColor=s,this.fillColor=i,this._minRadius=e,this._canvas.on("mouse:down",t=>this.onMouseDown(t)),this._canvas.on("mouse:move",t=>this.onMouseMove(t)),this._canvas.on("mouse:up",t=>this.onMouseUp(t)),this._canvas.on("mouse:out",t=>this.onMouseOut(t)),()=>{this._canvas.off("mouse:down"),this._canvas.off("mouse:move"),this._canvas.off("mouse:up"),this._canvas.off("mouse:out")}}onMouseDown(t){let e=this._canvas,s=t.e.button;this.isMouseDown=!0;let i=e.getPointer(t.e);this.currentStartX=i.x,this.currentStartY=i.y,this.currentCircle=new a.fabric.Circle({left:this.currentStartX,top:this.currentStartY,originX:"left",originY:"center",strokeWidth:this.strokeWidth,stroke:this.strokeColor,fill:this.fillColor,selectable:!1,evented:!1,radius:this._minRadius}),0===s&&e.add(this.currentCircle)}onMouseMove(t){if(!this.isMouseDown)return;let e=this._canvas,s=e.getPointer(t.e),i=this.linearDistance({x:this.currentStartX,y:this.currentStartY},{x:s.x,y:s.y})/2;this.currentCircle.set({radius:Math.max(i,this._minRadius),angle:180*Math.atan2(s.y-this.currentStartY,s.x-this.currentStartX)/Math.PI}),this.currentCircle.setCoords(),e.renderAll()}onMouseUp(t){this.isMouseDown=!1}onMouseOut(t){this.isMouseDown=!1}};var W=class extends x{constructor(){super(...arguments),this.isMouseDown=!1,this.strokeColor="#ffffff",this.strokeWidth=10,this.horizontalLine=null,this.verticalLine=null,this.coordinateCircle=null,this.coordinatesTextX=null,this.coordinatesTextY=null,this.tempHorizontalLine=null,this.tempVerticalLine=null,this.tempCoordinateCircle=null,this.tempCoordinatesText=null,this.coordinates_group=new a.fabric.Group,this.tempCoordinates_group=new a.fabric.Group,this.scaleFactors=[1,1,1,1,1,1],this.canvasWidth=1,this.canvasHeight=1}configureCanvas(t){let{strokeWidth:e,strokeColor:s,scaleFactors:i,canvasHeight:o,canvasWidth:r}=t;return this.scaleFactors=i,this.canvasHeight=o,this.canvasWidth=r,this._canvas.isDrawingMode=!1,this._canvas.selection=!1,this._canvas.forEachObject(t=>t.selectable=t.evented=!1),this.strokeWidth=e,this.strokeColor=s,this._canvas.on("mouse:down",t=>this.onMouseDown(t)),this._canvas.on("mouse:move",t=>this.onMouseMove(t)),this._canvas.on("mouse:up",t=>this.onMouseUp(t)),this._canvas.on("mouse:out",()=>this.onMouseOut()),()=>{this._canvas.off("mouse:down"),this._canvas.off("mouse:move"),this._canvas.off("mouse:up"),this._canvas.off("mouse:out"),this.clearTemporaryObjects()}}onMouseDown(t){if(0===t.e.button){this.isMouseDown=!0;let e=this._canvas.getPointer(t.e);this.drawLinesAndCoordinates(e.x,e.y)}}onMouseMove(t){let e=this._canvas.getPointer(t.e);this.isMouseDown||this.drawTemporaryLinesAndCoordinates(e.x,e.y)}onMouseUp(t){0===t.e.button&&(this.isMouseDown=!1,this.clearTemporaryObjects())}onMouseOut(){this.clearTemporaryObjects()}drawLinesAndCoordinates(t,e){let s=this._canvas,i=this.strokeWidth,o="rgba(99, 99, 156, .75)",r=this.canvasHeight,n=this.canvasWidth;this.horizontalLine=new a.fabric.Line([this.scaleFactors[3],e,t,e],{stroke:o,strokeWidth:i,selectable:!1,evented:!1,strokeDashArray:[10,5]}),this.verticalLine=new a.fabric.Line([t,e,t,.85*r],{stroke:o,strokeWidth:i,selectable:!1,evented:!1,strokeDashArray:[10,5]}),this.coordinateCircle=new a.fabric.Circle({left:t,top:e,radius:5,fill:o,selectable:!1,evented:!1,originX:"center",originY:"center"});let c=(t-this.scaleFactors[3])/(n-this.scaleFactors[3]-this.scaleFactors[5])*this.scaleFactors[0],l=this.scaleFactors[1]-(e-this.scaleFactors[4])/(r-this.scaleFactors[4]-this.scaleFactors[2])*this.scaleFactors[1];this.coordinatesTextX=new a.fabric.Text(""+c.toFixed(0),{left:t+.01*n,top:.8*r,fill:o,fontSize:14,selectable:!1,evented:!1}),this.coordinatesTextY=new a.fabric.Text(""+l.toFixed(0),{left:.13*n,top:e-.035*r,fill:o,fontSize:14,selectable:!1,evented:!1}),this.coordinates_group=new a.fabric.Group([this.horizontalLine,this.verticalLine,this.coordinateCircle,this.coordinatesTextX,this.coordinatesTextY],{selectable:!1,evented:!1}),s.add(this.coordinates_group),s.renderAll()}drawTemporaryLinesAndCoordinates(t,e){let s=this._canvas,i=this.strokeWidth,o="rgba(51, 0, 20, 0.5)",r=this.canvasHeight,n=this.canvasWidth;this.clearTemporaryObjects(),this.tempHorizontalLine=new a.fabric.Line([.12*n,e,t,e],{stroke:o,strokeWidth:i,selectable:!1,evented:!1,strokeDashArray:[10,5]}),this.tempVerticalLine=new a.fabric.Line([t,e,t,.85*r],{stroke:o,strokeWidth:i,selectable:!1,evented:!1,strokeDashArray:[10,5]}),this.tempCoordinateCircle=new a.fabric.Circle({left:t,top:e,radius:5,fill:o,selectable:!1,evented:!1,originX:"center",originY:"center"});let c=(t-this.scaleFactors[3])/(n-this.scaleFactors[3]-this.scaleFactors[5])*this.scaleFactors[0],l=this.scaleFactors[1]-(e-this.scaleFactors[4])/(r-this.scaleFactors[4]-this.scaleFactors[2])*this.scaleFactors[1];this.tempCoordinatesText=new a.fabric.Text(`(${c.toFixed(0)}, ${l.toFixed(0)})`,{left:t+10,top:e+10,fill:o,fontSize:14,selectable:!1,evented:!1}),this.tempCoordinates_group=new a.fabric.Group([this.tempHorizontalLine,this.tempVerticalLine,this.tempCoordinateCircle,this.tempCoordinatesText],{selectable:!1,evented:!1}),s.add(this.tempCoordinates_group),s.renderAll()}clearTemporaryObjects(){let t=this._canvas;this.tempCoordinates_group&&t.remove(this.tempCoordinates_group)}},R=s(15);var O=class extends x{constructor(){super(...arguments),this.isMouseDown=!1,this.fillColor="#ffffff00",this.strokeWidth=10,this.strokeColor="#ffffff",this.startCircle=new a.fabric.Circle,this.curvePath=new a.fabric.Path,this.tempCurvePath=new a.fabric.Path,this.controlPoints=[],this.points=[],this.tempCurve=new a.fabric.Path,this.finalCurve=new a.fabric.Path,this._pathString="M "}configureCanvas(t){let{strokeWidth:e,strokeColor:s,fillColor:i}=t;return this._canvas.isDrawingMode=!1,this._canvas.selection=!1,this._canvas.forEachObject(t=>t.selectable=t.evented=!1),this.strokeWidth=e,this.strokeColor=s,this.fillColor=i,this._canvas.on("mouse:down",t=>this.onMouseDown(t)),this._canvas.on("mouse:move",t=>this.onMouseMove(t)),this._canvas.on("mouse:up",t=>this.onMouseUp(t)),this._canvas.on("mouse:out",t=>this.onMouseOut(t)),this._canvas.on("mouse:dblclick",t=>this.onMouseDoubleClick(t)),()=>{this._canvas.off("mouse:down"),this._canvas.off("mouse:move"),this._canvas.off("mouse:up"),this._canvas.off("mouse:out")}}onMouseDown(t){let e=this._canvas,s=t.e.button,i=!1;"M "===this._pathString&&(i=!0),this.isMouseDown=!0;var o=e.getPointer(t.e);this.points.push([o.x,o.y]),i&&0===s?(this.controlPoints.push([o.x,o.y]),this._pathString=this.generateCurvePathData(this.controlPoints),this.startCircle=new a.fabric.Circle({left:o.x,top:o.y,originX:"center",originY:"center",strokeWidth:this.strokeWidth,stroke:this.strokeColor,fill:this.strokeColor,selectable:!1,evented:!1,radius:this.strokeWidth}),e.add(this.startCircle),i=!1):0===s&&(this.controlPoints.push([o.x,o.y]),this._pathString=this.generateCurvePathData(this.controlPoints))}onMouseMove(t){if(!this.isMouseDown)return;let e=this._canvas;var s=e.getPointer(t.e);this.points.push([s.x,s.y]);var i=this.generateCurvePathData(this.points);e.remove(this.tempCurve),this.tempCurve=new a.fabric.Path(i,{strokeWidth:this.strokeWidth,fill:"",stroke:this.strokeColor,selectable:!1,evented:!1}),e.add(this.tempCurve),this.points.pop()}onMouseUp(t){this.isMouseDown=!0}onMouseOut(t){this.isMouseDown=!1}onMouseDoubleClick(t){let e=this._canvas;e.remove(this.startCircle),e.remove(this.tempCurve),this.finalCurve=new a.fabric.Path(this._pathString,{strokeWidth:this.strokeWidth,fill:"#ffffff00",stroke:this.strokeColor,originX:"center",originY:"center",selectable:!1,evented:!1}),0!==this.finalCurve.width&&0!==this.finalCurve.height&&e.add(this.finalCurve),this._pathString="M ",this.controlPoints=[],this.points=[]}generateCurvePathData(t){return R.b().curve(R.a.alpha(.5))(t)}};var j=class extends x{configureCanvas(t){let{strokeWidth:e,strokeColor:s}=t;return this._canvas.isDrawingMode=!0,this._canvas.freeDrawingBrush.width=e,this._canvas.freeDrawingBrush.color=s,()=>{}}};var T=class extends x{constructor(){super(...arguments),this.isMouseDown=!1,this.strokeWidth=10,this.strokeColor="#ffffff",this.currentLine=new a.fabric.Line}configureCanvas(t){let{strokeWidth:e,strokeColor:s}=t;return this._canvas.isDrawingMode=!1,this._canvas.selection=!1,this._canvas.forEachObject(t=>t.selectable=t.evented=!1),this.strokeWidth=e,this.strokeColor=s,this._canvas.on("mouse:down",t=>this.onMouseDown(t)),this._canvas.on("mouse:move",t=>this.onMouseMove(t)),this._canvas.on("mouse:up",t=>this.onMouseUp(t)),this._canvas.on("mouse:out",t=>this.onMouseOut(t)),()=>{this._canvas.off("mouse:down"),this._canvas.off("mouse:move"),this._canvas.off("mouse:up"),this._canvas.off("mouse:out")}}onMouseDown(t){let e=this._canvas,s=t.e.button;this.isMouseDown=!0;var i=e.getPointer(t.e),o=[i.x,i.y,i.x,i.y];this.currentLine=new a.fabric.Line(o,{strokeWidth:this.strokeWidth,fill:this.strokeColor,stroke:this.strokeColor,originX:"center",originY:"center",selectable:!1,evented:!1}),0===s&&e.add(this.currentLine)}onMouseMove(t){if(!this.isMouseDown)return;let e=this._canvas;var s=e.getPointer(t.e);this.currentLine.set({x2:s.x,y2:s.y}),this.currentLine.setCoords(),e.renderAll()}onMouseUp(t){this.isMouseDown=!1;let e=this._canvas;0===this.currentLine.width&&0===this.currentLine.height&&e.remove(this.currentLine)}onMouseOut(t){this.isMouseDown=!1}};var P=class extends x{constructor(){super(...arguments),this.isMouseDown=!1,this.fillColor="#ffffff",this.strokeWidth=10,this.strokeColor="#ffffff",this.currentCircle=new a.fabric.Circle,this.currentStartX=0,this.currentStartY=0,this.displayRadius=1}configureCanvas(t){let{strokeWidth:e,strokeColor:s,fillColor:i,displayRadius:o}=t;return this._canvas.isDrawingMode=!1,this._canvas.selection=!1,this._canvas.forEachObject(t=>t.selectable=t.evented=!1),this.strokeWidth=e,this.strokeColor=s,this.fillColor=i,this.displayRadius=o,this._canvas.on("mouse:down",t=>this.onMouseDown(t)),this._canvas.on("mouse:move",t=>this.onMouseMove(t)),this._canvas.on("mouse:up",t=>this.onMouseUp(t)),this._canvas.on("mouse:out",t=>this.onMouseOut(t)),()=>{this._canvas.off("mouse:down"),this._canvas.off("mouse:move"),this._canvas.off("mouse:up"),this._canvas.off("mouse:out")}}onMouseDown(t){let e=this._canvas,s=t.e.button;this.isMouseDown=!0;let i=e.getPointer(t.e);this.currentStartX=i.x-(this.displayRadius+this.strokeWidth/2),this.currentStartY=i.y,this.currentCircle=new a.fabric.Circle({left:this.currentStartX,top:this.currentStartY,originX:"left",originY:"center",strokeWidth:this.strokeWidth,stroke:this.strokeColor,fill:this.fillColor,selectable:!1,evented:!1,radius:this.displayRadius}),0===s&&e.add(this.currentCircle)}onMouseMove(t){if(!this.isMouseDown)return;let e=this._canvas;this.currentCircle.setCoords(),e.renderAll()}onMouseUp(t){this.isMouseDown=!1}onMouseOut(t){this.isMouseDown=!1}};var U=class extends x{constructor(){super(...arguments),this.isMouseDown=!1,this.fillColor="#ffffff",this.strokeWidth=10,this.strokeColor="#ffffff",this.startCircle=new a.fabric.Circle,this.currentLine=new a.fabric.Line,this.currentPath=new a.fabric.Path,this._pathString="M "}configureCanvas(t){let{strokeWidth:e,strokeColor:s,fillColor:i}=t;return this._canvas.isDrawingMode=!1,this._canvas.selection=!1,this._canvas.forEachObject(t=>t.selectable=t.evented=!1),this.strokeWidth=e,this.strokeColor=s,this.fillColor=i,this._canvas.on("mouse:down",t=>this.onMouseDown(t)),this._canvas.on("mouse:move",t=>this.onMouseMove(t)),this._canvas.on("mouse:up",t=>this.onMouseUp(t)),this._canvas.on("mouse:out",t=>this.onMouseOut(t)),this._canvas.on("mouse:dblclick",t=>this.onMouseDoubleClick(t)),()=>{this._canvas.off("mouse:down"),this._canvas.off("mouse:move"),this._canvas.off("mouse:up"),this._canvas.off("mouse:out"),this._canvas.off("mouse:dblclick")}}onMouseDown(t){let e=this._canvas,s=t.e.button,i=!1;"M "===this._pathString&&(i=!0),this.isMouseDown=!0;var o=e.getPointer(t.e),r=[o.x,o.y,o.x,o.y];e.remove(this.currentLine),this.currentLine=new a.fabric.Line(r,{strokeWidth:this.strokeWidth,fill:this.strokeColor,stroke:this.strokeColor,originX:"center",originY:"center",selectable:!1,evented:!1}),0===s&&e.add(this.currentLine),i&&0===s?(this._pathString+=`${o.x} ${o.y} `,this.startCircle=new a.fabric.Circle({left:o.x,top:o.y,originX:"center",originY:"center",strokeWidth:this.strokeWidth,stroke:this.strokeColor,fill:this.strokeColor,selectable:!1,evented:!1,radius:this.strokeWidth}),e.add(this.startCircle),i=!1):(e.remove(this.currentPath),0===s&&(this._pathString+=`L ${o.x} ${o.y} `),2===s&&(this._pathString+="z",e.remove(this.startCircle))),this.currentPath=new a.fabric.Path(this._pathString,{strokeWidth:this.strokeWidth,fill:this.fillColor,stroke:this.strokeColor,originX:"center",originY:"center",selectable:!1,evented:!1}),0!==this.currentPath.width&&0!==this.currentPath.height&&e.add(this.currentPath),2===s&&(this._pathString="M ")}onMouseMove(t){if(!this.isMouseDown)return;let e=this._canvas;var s=e.getPointer(t.e);this.currentLine.set({x2:s.x,y2:s.y}),this.currentLine.setCoords(),e.renderAll()}onMouseUp(t){this.isMouseDown=!0}onMouseOut(t){this.isMouseDown=!1}onMouseDoubleClick(t){let e=this._canvas;this._pathString+="z",e.remove(this.startCircle),e.remove(this.currentPath),this.currentPath=new a.fabric.Path(this._pathString,{strokeWidth:this.strokeWidth,fill:this.fillColor,stroke:this.strokeColor,originX:"center",originY:"center",selectable:!1,evented:!1}),e.add(this.currentPath),this._pathString="M ",this.isMouseDown=!1}};var F=class extends x{constructor(){super(...arguments),this.isMouseDown=!1,this.fillColor="#ffffff",this.strokeWidth=10,this.strokeColor="#ffffff",this.currentRect=new a.fabric.Rect,this.currentStartX=0,this.currentStartY=0,this._minLength=10}configureCanvas(t){let{strokeWidth:e,strokeColor:s,fillColor:i}=t;return this._canvas.isDrawingMode=!1,this._canvas.selection=!1,this._canvas.forEachObject(t=>t.selectable=t.evented=!1),this.strokeWidth=e,this.strokeColor=s,this.fillColor=i,this._minLength=e,this._canvas.on("mouse:down",t=>this.onMouseDown(t)),this._canvas.on("mouse:move",t=>this.onMouseMove(t)),this._canvas.on("mouse:up",t=>this.onMouseUp(t)),this._canvas.on("mouse:out",t=>this.onMouseOut(t)),()=>{this._canvas.off("mouse:down"),this._canvas.off("mouse:move"),this._canvas.off("mouse:up"),this._canvas.off("mouse:out")}}onMouseDown(t){let e=this._canvas,s=t.e.button;this.isMouseDown=!0;let i=e.getPointer(t.e);this.currentStartX=i.x,this.currentStartY=i.y,this.currentRect=new a.fabric.Rect({left:this.currentStartX,top:this.currentStartY,originX:"left",originY:"top",width:this._minLength,height:this._minLength,stroke:this.strokeColor,strokeWidth:this.strokeWidth,fill:this.fillColor,transparentCorners:!1,selectable:!1,evented:!1,strokeUniform:!0,noScaleCache:!1,angle:0}),0===s&&e.add(this.currentRect)}onMouseMove(t){if(!this.isMouseDown)return;let e=this._canvas,s=e.getPointer(t.e);this.currentStartX>s.x&&this.currentRect.set({left:Math.abs(s.x)}),this.currentStartY>s.y&&this.currentRect.set({top:Math.abs(s.y)});let i=Math.abs(this.currentStartX-s.x),o=Math.abs(this.currentStartY-s.y);this.currentRect.set({width:Math.max(i,2*this._minLength),height:Math.max(o,2*this._minLength)}),this.currentRect.setCoords(),e.renderAll()}onMouseUp(t){this.isMouseDown=!1}onMouseOut(t){this.isMouseDown=!1}};var X=class extends x{configureCanvas(){return this._canvas.isDrawingMode=!1,this._canvas.selection=!1,this._canvas.forEachObject(t=>t.selectable=t.evented=!1),this._canvas.on("mouse:down",t=>this.onMouseDown(t)),()=>{this._canvas.off("mouse:down")}}onMouseDown(t){let e=this._canvas,s=t.e.button;var i=e.getPointer(t.e);if(0===s){let t=new a.fabric.IText("",{left:i.x,top:i.y,fontSize:25,selectable:!0,evented:!0});e.add(t),e.setActiveObject(t),t.enterEditing(),t.hiddenTextarea&&t.hiddenTextarea.focus()}}};const Y={circle:L,curve:O,coordinate:W,text:X,freedraw:j,line:T,polygon:U,rect:F,singlearrowhead:D,doublearrowhead:E,transform:class extends x{configureCanvas(t){let e=this._canvas;e.isDrawingMode=!1,e.selection=!0,e.forEachObject(t=>t.selectable=t.evented=!0);const s=()=>{e.remove(e.getActiveObject())};return e.on("mouse:dblclick",s),()=>{e.off("mouse:dblclick",s)}}},point:P};let B;var I=t=>{let{id:e,fillColor:s,strokeWidth:r,strokeColor:n,backgroundColor:l,backgroundImageURL:h,canvasWidth:u,canvasHeight:d,drawingMode:f,initialDrawing:v,displayToolbar:m,displayRadius:g,scaleFactors:p}=t;const[k,b]=Object(i.useState)(null),[C,M]=Object(i.useState)(null),{canvasState:{action:{shouldReloadCanvas:A},currentState:S,initialState:y},saveState:x,undo:D,redo:E,canUndo:L,canRedo:W,resetState:R}=Object(i.useContext)(_);Object(i.useEffect)(()=>{const t=new a.fabric.Canvas("canvas-"+e,{enableRetinaScaling:!1}),s=new a.fabric.StaticCanvas("backgroundimage-canvas-"+e,{enableRetinaScaling:!1});b(t),M(s);const i=document.getElementById("canvas-"+e);return i&&i.addEventListener("contextmenu",t=>{t.preventDefault()}),()=>{i&&i.removeEventListener("contextmenu",t=>{t.preventDefault()})}},[e]),Object(i.useEffect)(()=>{k&&!Object(c.isEqual)(y,v)&&k.loadFromJSON(v,()=>{null===k||void 0===k||k.renderAll(),R(v)})},[k,v,y,R]),Object(i.useEffect)(()=>{if(C&&h){const t=new Image;t.onload=function(){C.getContext().drawImage(t,0,0)},t.src=h}C&&(B=((t,e)=>new a.fabric.Rect({left:75,top:25,fill:"white",width:t-100,height:e-100,stroke:"black",strokeWidth:1,selectable:!1,evented:!1,lockMovementX:!0,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,hasControls:!1}))(u,d),C.add(B),C.renderAll())},[C,d,u,l,h,x]),Object(i.useEffect)(()=>{k&&A&&k.loadFromJSON(S,()=>{k.renderAll()})},[k,A,S]),Object(i.useEffect)(()=>{if(k){const t=new Y[f](k).configureCanvas({fillColor:s,strokeWidth:r,strokeColor:n,displayRadius:g,scaleFactors:p,canvasHeight:d,canvasWidth:u}),e=()=>{x(k.toJSON())};return k.on("mouse:up",e),k.on("mouse:dblclick",e),()=>{t(),k.off("mouse:up",e),k.off("mouse:dblclick",e)}}},[k,r,n,g,s,f,v,p,d,u,x]);return o.a.createElement("div",{style:{position:"relative"}},o.a.createElement("div",{style:{position:"absolute",top:0,left:0,zIndex:0}},o.a.createElement("canvas",{id:"backgroundimage-canvas-"+e,width:u,height:d})),o.a.createElement("div",{style:{position:"absolute",top:0,left:0,zIndex:10,backgroundColor:"rgba(255, 0, 0, 0.1)"}},o.a.createElement("canvas",{id:"canvas-"+e,width:u,height:d,style:{border:"lightgrey 1px solid"}}),m&&o.a.createElement(w,{topPosition:0,leftPosition:u,downloadCallback:()=>{if(k&&C){const t=document.createElement("canvas");t.width=u,t.height=d;const e=t.getContext("2d");if(e){e.drawImage(C.getElement(),0,0),e.drawImage(k.getElement(),0,0);const s=t.toDataURL("image/png"),i=document.createElement("a");i.href=s,i.download="canvas.png",i.click()}}},canUndo:L,canRedo:W,undoCallback:D,redoCallback:E,resetCallback:()=>{R(y)}})))},N=s(102),z=s(103),H=s(104),V=s(105),G=s(106),Q=s(107),J=s(108),q=s(109),K=s(110),Z=s(111);var $=t=>{let{drawingMode:e,setDrawingMode:s}=t;const i=[{mode:"line",icon:"/complete-react-drawing-app/line.png",description:"Draw a line"},{mode:"singlearrowhead",icon:N.a,description:"Draw a single arrowhead"},{mode:"doublearrowhead",icon:z.a,description:"Draw a double arrowhead"},{mode:"point",icon:H.a,description:"Draw a point"},{mode:"polygon",icon:V.a,description:"Draw a polygon"},{mode:"rect",icon:G.a,description:"Draw a rectangle"},{mode:"circle",icon:Q.a,description:"Draw a circle"},{mode:"freedraw",icon:J.a,description:"Free draw"},{mode:"coordinate",icon:"/complete-react-drawing-app/coordicon.png",description:"Draw coordinates"},{mode:"curve",icon:q.a,description:"Draw a curve"},{mode:"text",icon:K.a,description:"Add text"},{mode:"transform",icon:Z.a,description:"Select & move shapes"}];return o.a.createElement("div",null,o.a.createElement("div",{style:{display:"flex",gap:"1px",flexWrap:"wrap"}},i.map(t=>{let{mode:i,icon:r,description:n}=t;return o.a.createElement("button",{key:i,type:"button",onClick:()=>s(i),title:n,style:{backgroundColor:e===i?"rgb(187, 182, 182)":"white",border:"0px solid black",margin:"0px",padding:"5px",cursor:"pointer",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"20%"}},"string"===typeof r?o.a.createElement("img",{src:r,alt:i,style:{width:"24px",height:"24px"}}):o.a.createElement(r,{style:{width:"24px",height:"24px"}}))})))};var tt=function(t){let{id:e}=t;const[s,r]=Object(i.useState)("point"),[n,a]=Object(i.useState)("black"),[c,l]=Object(i.useState)(2),h={id:e,fillColor:"transparent",strokeWidth:c,strokeColor:n,backgroundColor:"blue",backgroundImageURL:"",canvasWidth:700,canvasHeight:500,drawingMode:s,initialDrawing:[{}],displayToolbar:!0,displayRadius:3,scaleFactors:[100,100,75,84,25,35]};return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",null,o.a.createElement(y,null,o.a.createElement("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"}},o.a.createElement($,{drawingMode:s,setDrawingMode:r}),o.a.createElement("div",{style:{marginLeft:"10px"}},o.a.createElement("label",{htmlFor:"strokeColor"},"Stroke Color: "),o.a.createElement("input",{type:"color",id:"strokeColor",value:n,onChange:t=>a(t.target.value)})),o.a.createElement("div",{style:{marginLeft:"10px"}},o.a.createElement("label",{htmlFor:"strokeWidth"},"Stroke Width: "),o.a.createElement("input",{type:"range",id:"strokeWidth",value:c,min:"1",max:"5",onChange:t=>l(Number(t.target.value)),style:{width:"75px"}}),o.a.createElement("span",null,c))),o.a.createElement(I,Object.assign({},h,{id:""+e})))))};s(98);var et=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},o.a.createElement("h1",null,"Drawing App for Economics work!")),o.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"flex-start"}},o.a.createElement("div",{style:{flex:1,padding:"10px"}},o.a.createElement("h2",null,"Legend:"),o.a.createElement("ul",null,o.a.createElement("li",null,"Hoover over the drawing tools and you will see a pop-up text that tells you what each tool does"),o.a.createElement("li",null,"For the 'polygon' tool, just left-mouse click to get the corners of the polygon and end with double click to close the polygon"),o.a.createElement("li",null,"For the 'curve' tool, click at the desired points to mark the 'control points' of the curve and end by double clicking."),o.a.createElement("li",null," For all the other tools, just click and drag"))),o.a.createElement("div",{style:{flex:2}},o.a.createElement(tt,null))))};s(99);n.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(et,null)),document.getElementById("root"))},14:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAwwAAAMMBnc7+MwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAEFSURBVEiJ7dSxLkRBFMbx31BIlkQlHoCap5BQLAXvQafV6DyLRLYSdkWv0dBQ0NAKkUhkj2bEzc3udW9xE5E9yVfNd85/5pyZSRGhzZhqtfoE8DcAKaVOqwD0mkBSSnNNAAmBAboR8V4qtoguVrNWMI9n3Gad4SQqHlRk9dHJvmns4qWwXqUrbESEspSMfazhekyhN9zhc8z6KWarAKN0jm0sI+WkmdyuPTyV/JdFSBXgATujjl3aYQf7+CjkXhTaPRYw+DbVETZLkMM6Leo3hGxhmHNfsVBnBk0hx4XcozqARpA8/GG+bQcJ6+rFTUQ81jGmlJYi4p6fa9da/IPvegL4Lb4A0uc9nRaYXwcAAAAASUVORK5CYII="},26:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAhQAAAIUB4uz/wQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAHUSURBVEiJtda9ahRRFAfw3xHFJCabFEkawcYiYKMWVmohBHwFOwsfQLCxthOENHZqKxZG8DHSxcJC0Qcw7AqSNSoGci3mznp3nP0K8cBlZs7X/5z//RopJeMGlrGL1Bi7WJ4Uf9pk2cQVPMDPrJvHVra9GRc8BBARS7iKU4X6cn5+wvf8vljbIuJr4XuEdyml/YGmoGIdX/xLxayji/U2iu5iJXfwa1zbY2QOOznXE4YpuoE93D5m8lr2cLMN4BWu4TF+4HDGxIEOeng90DaW5BkVj/fyd6dhP4u5hq6Tnxdz7GZpL1eLlNIhvmEtq7Yj4mHhsoWng5Ir23b+rGO6Zc62fdAtnFewUdjOqyaylo3sMxJgqIMsvcJ5X8XrKFlCvwHQmwRQdjArwH5K6fc0AKvHAFjVoGcUwCwUdbKPHNNrOpw0RVN10MVCRCz8T4A6oI/FiIiTBKh5XFN1EDnRkETEnGrnH2sOSoC60rbqoR8R8zg3bQe102oB0DYPAwB/l/VkgJTSgeo+KDtoA6h1fSN2Me1nUV3JOj7iOT5k/csi5jNe4D2uj+og8lE7rIx4hjt4hIMRRZRyX7UYLqWUjoYsI35VLuCt6tKZ5h7ewa22XH8AgjMTispa6ucAAAAASUVORK5CYII="},27:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAsQAAALEBxi1JjQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAEYSURBVEiJ7dS9SgNBFMXxX0y0NNpLqjQiKRRETON7aBMfwLfxDcRGC8HOTm21s7RIYZdniGiRO+6y5mNXVxD0wMBw58z532Fnh1+kFq5jNH8C0MFbjE7ZTUsVAEsz5rUBvqR/wB8CNLFeY+5aZH4ArjDCXsHYNv+vbWK1UNuNrMs8oGfyFGzmjDthvA9QUe1YG4U3aQvL2M4DpqkRHfZxU4C0o9aPxhpzcsDQ5I0ZFOpHGMfas+wtSvNxePIaxNpw0QngHIcR1M3Vu3jFcXhmqsw1vZCdJCmFny3a3CoBSBAm3TbKhlcBJEj6Vo9lN1UBwENF/yfAAVaqhhS0P614J7uCdY1bsh+kh1NsfLP7pBec4KmmvNl6B0BuQt0zCQ0xAAAAAElFTkSuQmCC"},85:function(t,e,s){t.exports=s(100)},94:function(t,e){},95:function(t,e){},96:function(t,e){},98:function(t,e,s){},99:function(t,e,s){}},[[85,1,2]]]);
//# sourceMappingURL=main.c7c92d6f.chunk.js.map